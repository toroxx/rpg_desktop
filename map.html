<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <ul
        style="display:flex; flex-direction: row; flex-wrap:wrap; width:100%; list-style: none; padding:0px; margin:0px;">

        <li style="padding: 5px;"><a href="?file=BBPA_Outside_A.png">BBPA_Outside_A.png</a></li>
        <li style="padding: 5px;"><a href="?file=BBPA_Outside_Ayogore.png">BBPA_Outside_Ayogore.png</a></li>
        <li style="padding: 5px;"><a href="?file=BBPA_Outside_B.png">BBPA_Outside_B.png</a></li>
        <li style="padding: 5px;"><a href="?file=BBPA_Outside_Byogore.png">BBPA_Outside_Byogore.png</a></li>
        <li style="padding: 5px;"><a href="?file=BB_aki_Outside_A2.png">BB_aki_Outside_A2.png</a></li>
        <li style="padding: 5px;"><a href="?file=BB_syunkasyuutou.png">BB_syunkasyuutou.png</a></li>
        <li style="padding: 5px;"><a href="?file=fire.png">fire.png</a></li>
        <li style="padding: 5px;"><a href="?file=inakayuka.png">inakayuka.png</a></li>
        <li style="padding: 5px;"><a href="?file=inakayuka1.png">inakayuka1.png</a></li>
        <li style="padding: 5px;"><a href="?file=inakayuka2.png">inakayuka2.png</a></li>
        <li style="padding: 5px;"><a href="?file=SC-Door-Schl02.png">SC-Door-Schl02.png</a></li>
        <li style="padding: 5px;"><a href="?file=SPT-Gym01.png">SPT-Gym01.png</a></li>
        <li style="padding: 5px;"><a href="?file=ST-Office-I01.png">ST-Office-I01.png</a></li>
        <li style="padding: 5px;"><a href="?file=ST-Schl-E01.png">ST-Schl-E01.png</a></li>
        <li style="padding: 5px;"><a href="?file=ST-Schl-Gym.png">ST-Schl-Gym.png</a></li>
        <li style="padding: 5px;"><a href="?file=ST-Schl-I01.png">ST-Schl-I01.png</a></li>
        <li style="padding: 5px;"><a href="?file=ST-Schl-I02.png">ST-Schl-I02.png</a></li>
        <li style="padding: 5px;"><a href="?file=ST-Toilet-I01.png">ST-Toilet-I01.png</a></li>
    </ul>

    <div>
        Tile Per Row: <input class="tile_per_row" value="8" onchange="redraw()" />
        Tile Size: <span class="tile_size"></span>
    </div>
    <div class="frames" style="position: relative;">
        <img class="img" src="" />
    </div>
    <script>
        // window.location;

        let img_width = 0;
        let img_height = 0;
        let url = window.location.href;
        if (url.indexOf('?file=') > -1) {
            var filename = url.split('?file=')[1];
            //console.log(filename);
            let img = document.querySelector('img.img');
            img.src = "assets/elements/" + filename;
            img.onload = function () {
                img.width = img.width * 2;
                img_width = img.width;
                img_height = img.height;

                redraw();
            }
        }
        function redraw() {
            let frames = document.querySelectorAll('div.frame');
            frames.forEach(e => e.parentNode.removeChild(e));
            let tile_per_row = document.querySelector('.tile_per_row').value;
            tile_per_row = parseInt(tile_per_row, 10);
            if (parseInt(tile_per_row, 10) <= 0) {
                tile_per_row = 1;
            }
            // get tile_size 
            let tile_size = img_width / tile_per_row;

            let cols = Math.ceil(img_width / tile_size);
            let rows = Math.ceil(img_height / tile_size);

            let divframes = document.querySelector('div.frames');
            document.querySelector('span.tile_size').innerHTML = tile_size + ' Cols:' + cols + ' Row:' + rows;
            const alpha = '.8';
            let color_tiles = [
                'rgba(255,0,0,' + alpha + ')', 'rgba(0,0,0,' + alpha + ')', 'rgba(0,255,0,' + alpha + ')', 'rgba(0,0,255,' + alpha + ')',
                'rgba(255,255,0,' + alpha + ')', 'rgba(0,255,255,' + alpha + ')', 'rgba(255,0,255,' + alpha + ')'
            ];
            let x = 0;
            for (let i = 0; i < rows; i++) {
                for (let j = 0; j < cols; j++) {
                    let div = document.createElement("DIV");
                    div.style.position = 'absolute';
                    div.className = 'frame';
                    div.style.left = (j * tile_size) + 'px';
                    div.style.top = (i * tile_size) + 'px';
                    //div.style.backgroundColor =;
                    div.innerHTML = '<table style="border:2px solid '+ color_tiles[x % color_tiles.length]+'; text-align:center;  width:' + tile_size + 'px; height:' + tile_size + 'px"><tr><td>' +(i*8+j)+' '+ i + 'x' + j + '</td></tr></table>';
                    divframes.appendChild(div);
                    x++;
                }
            }
        }
    </script>
</body>

</html>